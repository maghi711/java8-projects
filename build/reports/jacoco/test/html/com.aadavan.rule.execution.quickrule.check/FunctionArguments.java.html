<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>FunctionArguments.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">java8-projects</a> &gt; <a href="index.source.html" class="el_package">com.aadavan.rule.execution.quickrule.check</a> &gt; <span class="el_source">FunctionArguments.java</span></div><h1>FunctionArguments.java</h1><pre class="source lang-java linenums">package com.aadavan.rule.execution.quickrule.check;

import java.io.Serializable;
import java.util.logging.Logger;

import static jeval.EvaluationConstants.FUNCTION_ARGUMENT_SEPARATOR;

<span class="nc" id="L8">public class FunctionArguments implements Serializable {</span>
<span class="nc" id="L9">	private static final Logger logger = Logger.getLogger(FunctionArguments.class.getName());</span>
<span class="nc" id="L10">	static boolean QUICK_RULE_ENCODE_SPECIAL_CHAR_ENABLED = false;</span>
	String ruleId;	
	String operand;
	String subject;
	String rawParamName;	
	String rawFunctionName;	
	String implementationFunctionName;
	String cardNo;	
	String uid;
	String ruleSubject;
	String clientId;
	String paramName;
	
	public String getParamName() {
<span class="nc" id="L24">		return paramName;</span>
	}

	public void setParamName(String paramName) {
<span class="nc" id="L28">		this.paramName = paramName;</span>
<span class="nc" id="L29">	}</span>

	public String getUid() {
<span class="nc" id="L32">		return uid;</span>
	}

	public String getRuleSubject() {
<span class="nc" id="L36">		return ruleSubject;</span>
	}

	public void setUid(String uid) {
<span class="nc" id="L40">		this.uid = uid;</span>
<span class="nc" id="L41">	}</span>

	public void setRuleSubject(String ruleSubject) {
<span class="nc" id="L44">		this.ruleSubject = ruleSubject;</span>
<span class="nc" id="L45">	}</span>
	
	public String getRuleId() {
<span class="nc bnc" id="L48" title="All 2 branches missed.">		if(ruleId != null){</span>
<span class="nc" id="L49">			ruleId = ruleId.replace(&quot;'&quot;, &quot;&quot;);	</span>
		}		
<span class="nc" id="L51">		return ruleId;</span>
	}

	public void setRuleId(String ruleId) {
<span class="nc" id="L55">		this.ruleId = ruleId;</span>
<span class="nc" id="L56">	}</span>

	public String getClientId() {
<span class="nc" id="L59">		clientId = clientId.replace(&quot;'&quot;, &quot;&quot;);</span>
<span class="nc" id="L60">		return clientId;</span>
	}

	public void setClientId(String clientId) {
<span class="nc" id="L64">		this.clientId = clientId;</span>
<span class="nc" id="L65">	}</span>

	public String getOperand() {
<span class="nc" id="L68">		return operand;</span>
	}

	public void setOperand(String operand) {
<span class="nc" id="L72">		this.operand = operand;</span>
<span class="nc" id="L73">	}</span>

	public String getSubject() {
<span class="nc" id="L76">		return subject;</span>
	}

	public void setSubject(String subject) {
<span class="nc" id="L80">		this.subject = subject;</span>
<span class="nc" id="L81">	}</span>

	public String getRawParamName() {
<span class="nc" id="L84">		return rawParamName;</span>
	}

	public void setRawParamName(String rawParamName) {
<span class="nc" id="L88">		this.rawParamName = rawParamName;</span>
<span class="nc" id="L89">	}</span>

	public String getRawFunctionName() {
<span class="nc" id="L92">		return rawFunctionName;</span>
	}

	public void setRawFunctionName(String rawFunctionName) {
<span class="nc" id="L96">		this.rawFunctionName = rawFunctionName;</span>
<span class="nc" id="L97">	}	</span>
	
	public String getCardNo() {
<span class="nc" id="L100">		return cardNo;</span>
	}

	public void setCardNo(String cardNo) {
<span class="nc" id="L104">		this.cardNo = cardNo;</span>
<span class="nc" id="L105">	}</span>

	public String getImplementationFunctionName() {
<span class="nc" id="L108">		return implementationFunctionName;</span>
	}

	public void setImplementationFunctionName(String implementationFunctionName) {
<span class="nc" id="L112">		this.implementationFunctionName = implementationFunctionName;</span>
<span class="nc" id="L113">	}</span>

	public static FunctionArguments getFunctionArguments(String argumentString){
<span class="nc bnc" id="L116" title="All 2 branches missed.">		if(&quot;true&quot;.equals(QUICK_RULE_ENCODE_SPECIAL_CHAR_ENABLED)){</span>
<span class="nc" id="L117">			argumentString = FunctionArguments.decodeSpecialChar(argumentString);</span>
		}		
<span class="nc bnc" id="L119" title="All 2 branches missed.">		if(&quot;true&quot;.equals(&quot;true&quot;)){</span>
<span class="nc" id="L120">			logger.info(&quot;Actual arg1 :&quot;+argumentString);</span>
		}
<span class="nc" id="L122">		FunctionArguments fa = new FunctionArguments();</span>
		String operand;
		String subject;
		String rawParamName;
<span class="nc" id="L126">		int indexOfRawArgument = 0;		</span>
		
<span class="nc bnc" id="L128" title="All 2 branches missed.">		if(argumentString == null){</span>
<span class="nc" id="L129">			return null;</span>
		}		
		
<span class="nc bnc" id="L132" title="All 2 branches missed.">		if( argumentString.contains(&quot;~~~&quot;)){</span>
<span class="nc" id="L133">			String tem = argumentString.substring(argumentString.indexOf(&quot;~~~&quot;),argumentString.length());</span>
		
<span class="nc" id="L135">			String args[] = tem.split(&quot;~~~&quot;, -1);</span>
			
<span class="nc" id="L137">			rawParamName = args[1];</span>
<span class="nc" id="L138">			fa.setRawFunctionName( args[2]) ;</span>
			
<span class="nc bnc" id="L140" title="All 2 branches missed.">			if(args.length &gt;= 3){			</span>
<span class="nc" id="L141">				fa.setCardNo( args[3]) ;</span>
			}
			
<span class="nc bnc" id="L144" title="All 2 branches missed.">			if(args.length &gt;= 4){	</span>
<span class="nc" id="L145">				String clientId = args[4];</span>
<span class="nc" id="L146">				clientId = clientId.replace(&quot;'&quot;, &quot;&quot;);</span>
<span class="nc" id="L147">				fa.setClientId( args[4]) ;</span>
			}
			
<span class="nc bnc" id="L150" title="All 2 branches missed.">			if(args.length &gt;= 5){	</span>
<span class="nc" id="L151">				String ruleId = args[5];				</span>
<span class="nc" id="L152">				fa.setRuleId( args[5]) ;</span>
			}
			
<span class="nc bnc" id="L155" title="All 2 branches missed.">			if(args.length &gt;= 6){	</span>
<span class="nc" id="L156">				String uid = args[6];				</span>
<span class="nc" id="L157">				fa.setUid(uid) ;</span>
			}
			
<span class="nc bnc" id="L160" title="All 2 branches missed.">			if(args.length &gt;= 7){	</span>
<span class="nc" id="L161">				String ruleSubject = args[7];				</span>
<span class="nc" id="L162">				fa.setRuleSubject(ruleSubject) ;</span>
			}
			
<span class="nc bnc" id="L165" title="All 2 branches missed.">			if(args.length &gt;= 8){	</span>
<span class="nc" id="L166">				String paramName = args[8];				</span>
<span class="nc" id="L167">				fa.setParamName(paramName) ;</span>
			}
			
<span class="nc" id="L170">		}else{</span>
<span class="nc" id="L171">			rawParamName = &quot;&quot;;</span>
<span class="nc" id="L172">			fa.setRawFunctionName(&quot;&quot;);</span>
		}
<span class="nc bnc" id="L174" title="All 2 branches missed.">		if(&quot;true&quot;.equals(&quot;true&quot;)){</span>
<span class="nc" id="L175">			logger.info(&quot;argumentString :&quot;+argumentString);</span>
		}
<span class="nc" id="L177">		String[] argList = argumentString.split(&quot;','&quot; ,-1);	</span>
<span class="nc" id="L178">		operand = argList[0];</span>
<span class="nc" id="L179">		subject = argList[1];</span>
		
		/*
		if(operand != null &amp;&amp; operand.contains(&quot;#COMMA#&quot;)){
			operand = operand.replace(&quot;#COMMA#&quot;, &quot;,&quot;);
		}
		
		if(subject != null &amp;&amp; subject.contains(&quot;#COMMA#&quot;)){
			subject = subject.replace(&quot;#COMMA#&quot;, &quot;,&quot;);
		}
		*/
		
<span class="nc" id="L191">		indexOfRawArgument = subject.indexOf(&quot;~~~&quot;);</span>
<span class="nc" id="L192">		subject = subject.substring(0, indexOfRawArgument);</span>
		
<span class="nc" id="L194">		operand = operand.replace(&quot;'&quot;, &quot;&quot;);</span>
<span class="nc" id="L195">		subject = subject.replace(&quot;'&quot;,&quot;&quot;);</span>
		
<span class="nc" id="L197">		fa.setOperand(operand);		</span>
<span class="nc" id="L198">		fa.setRawParamName(rawParamName);</span>
<span class="nc" id="L199">		fa.setSubject(subject);</span>
<span class="nc bnc" id="L200" title="All 2 branches missed.">		if(&quot;true&quot;.equals(&quot;true&quot;)){</span>
<span class="nc" id="L201">			logger.info(&quot;Raw getRawFunctionName:&quot;+fa.getRawFunctionName());</span>
<span class="nc" id="L202">			logger.info(&quot;Raw getRawParamName:&quot;+fa.getRawParamName());</span>
<span class="nc" id="L203">			logger.info(&quot;operand:&quot;+operand);</span>
<span class="nc" id="L204">			logger.info(&quot;subject:&quot;+subject);</span>
		}
		
<span class="nc" id="L207">		return fa;	</span>
	}
	
	public String getFunctionExpression(){
		//
<span class="nc" id="L212">		String rawArgument = getRawParamName();</span>
<span class="nc" id="L213">		String functionNameFromUI = getRawFunctionName();</span>
<span class="nc" id="L214">		String functionArgument1 = getOperand();</span>
<span class="nc" id="L215">		String functionArgument2 = getSubject();</span>
<span class="nc" id="L216">		String functionName = getImplementationFunctionName();</span>
<span class="nc" id="L217">		String cardno = getCardNo();</span>
<span class="nc" id="L218">		String clientId = getClientId();</span>
<span class="nc" id="L219">		String ruleId =getRuleId();</span>
<span class="nc" id="L220">		String uid = getUid();</span>
<span class="nc" id="L221">		String ruleSubject = getRuleSubject();</span>
	 
	    
<span class="nc" id="L224">	    StringBuilder sb = new StringBuilder();</span>

<span class="nc" id="L226">	    rawArgument = rawArgument.replace(&quot;{&quot;, &quot;[&quot;);</span>
<span class="nc" id="L227">	    rawArgument = rawArgument.replace(&quot;}&quot;, &quot;]&quot;);</span>
	   
<span class="nc" id="L229">	    functionArgument2 = functionArgument2.replace(&quot;'&quot;, &quot;&quot;);</span>
	    
<span class="nc" id="L231">	    sb.append(functionName).append(&quot;&quot;);</span>
<span class="nc" id="L232">	    sb.append(&quot;(&quot;);</span>
	    
<span class="nc" id="L234">    	sb.append(&quot; &quot;);</span>
<span class="nc" id="L235">    		sb.append(&quot;'&quot;).append(functionArgument1.replaceAll(&quot;'&quot;, &quot;&quot;)).append(&quot;'&quot;);</span>
<span class="nc" id="L236">            sb.append(FUNCTION_ARGUMENT_SEPARATOR);</span>
//	    sb.append(&quot;,&quot;);
<span class="nc" id="L238">	    	sb.append(&quot;'&quot;).append(functionArgument2);</span>
	    
	   
<span class="nc" id="L241">	    sb.append(&quot;~~~&quot;);</span>
<span class="nc" id="L242">	    sb.append(rawArgument);</span>
	    	
<span class="nc" id="L244">	    sb.append(&quot;~~~&quot;);</span>
<span class="nc" id="L245">	    sb.append(functionNameFromUI);	</span>
	    	
<span class="nc" id="L247">	    sb.append(&quot;~~~&quot;);</span>
<span class="nc" id="L248">	    sb.append(cardno);</span>
	    
<span class="nc" id="L250">	    sb.append(&quot;~~~&quot;);  	  </span>
<span class="nc" id="L251">	    sb.append(clientId);		    </span>
	   	
<span class="nc" id="L253">	    sb.append(&quot;~~~&quot;);</span>
<span class="nc" id="L254">	    sb.append(ruleId);</span>
	    
<span class="nc" id="L256">	    sb.append(&quot;~~~&quot;);</span>
<span class="nc" id="L257">	    sb.append(uid);</span>
	    
<span class="nc" id="L259">	    sb.append(&quot;~~~&quot;);</span>
<span class="nc" id="L260">	    sb.append(ruleSubject);</span>
	    
<span class="nc" id="L262">	    sb.append(&quot;~~~&quot;);</span>
<span class="nc" id="L263">	    sb.append(paramName);	    </span>
	    
<span class="nc" id="L265">	    sb.append(&quot;'&quot;);</span>
	    
	       
<span class="nc" id="L268">	    sb.append(&quot; &quot;);	    </span>
<span class="nc" id="L269">	    sb.append(&quot;)&quot;);</span>
	    
<span class="nc" id="L271">	    logger.info(sb.toString());</span>
<span class="nc" id="L272">	    return sb.toString();</span>
	}




	@Override
	public String toString() {
<span class="nc" id="L280">		return &quot;FunctionArguments [ruleId=&quot; + ruleId + &quot;, operand=&quot; + operand + &quot;, subject=&quot; + subject</span>
				+ &quot;, rawParamName=&quot; + rawParamName + &quot;, rawFunctionName=&quot; + rawFunctionName
				+ &quot;, implementationFunctionName=&quot; + implementationFunctionName + &quot;, cardNo=&quot; + cardNo + &quot;, uid=&quot; + uid
				+ &quot;, ruleSubject=&quot; + ruleSubject + &quot;, clientId=&quot; + clientId + &quot;, paramName=&quot; + paramName + &quot;]&quot;;
	}

	public static String encodeSpecialChar(String param){
<span class="nc" id="L287">		String[] elements = param.split(&quot;','&quot;,-1);</span>
<span class="nc bnc" id="L288" title="All 2 branches missed.">		if(elements.length == 2){</span>
<span class="nc" id="L289">			String elementZero = elements[0];</span>
<span class="nc" id="L290">			String elementOne = elements[1];</span>
<span class="nc bnc" id="L291" title="All 2 branches missed.">			if(elementZero.contains(&quot;,&quot;)){</span>
<span class="nc" id="L292">				elementZero = elementZero.replace(&quot;,&quot;, &quot;COMMA&quot;);</span>
			}
<span class="nc bnc" id="L294" title="All 2 branches missed.">			if(elementOne.contains(&quot;,&quot;)){</span>
<span class="nc" id="L295">				elementOne = elementOne.replace(&quot;,&quot;, &quot;COMMA&quot;);</span>
			}
<span class="nc" id="L297">			return elementZero+&quot;','&quot;+elementOne;	</span>
		}else{
<span class="nc" id="L299">			return param;</span>
		}
	}
	
	public static String decodeSpecialChar(String param){
<span class="nc" id="L304">		String[] elements = param.split(&quot;','&quot;,-1);</span>
<span class="nc bnc" id="L305" title="All 2 branches missed.">		if(elements.length == 2){</span>
<span class="nc" id="L306">			String elementZero = elements[0];</span>
<span class="nc" id="L307">			String elementOne = elements[1];</span>
<span class="nc bnc" id="L308" title="All 2 branches missed.">			if(elementZero.contains(&quot;COMMA&quot;)){</span>
<span class="nc" id="L309">				elementZero = elementZero.replace(&quot;COMMA&quot;, &quot;,&quot;);</span>
			}
<span class="nc bnc" id="L311" title="All 2 branches missed.">			if(elementOne.contains(&quot;COMMA&quot;)){</span>
<span class="nc" id="L312">				elementOne = elementOne.replace(&quot;COMMA&quot;, &quot;,&quot;);</span>
			}
<span class="nc" id="L314">			return elementZero+&quot;','&quot;+elementOne;</span>
		}else{
<span class="nc" id="L316">			return param;</span>
		}
	}
	
	
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.3.201901230119</span></div></body></html>